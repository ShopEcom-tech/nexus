import{c as l,g as R,o as U,a as i,j as e,O as _,m as f,b as M,M as D,w as S,T as q,C as T,y as g,z as L}from"./index-BHyKrKGo.js";import{T as I}from"./twitter-BsyFqFUU.js";import{U as j}from"./users-CFKhssQv.js";const P=l("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),F=l("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),H=l("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),O=l("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),W=l("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),Q=()=>{R();const{user:r,profile:V}=U(),[n,x]=i.useState(""),[c,b]=i.useState({clicks:0,signups:0,conversions:0,pendingEarnings:0,paidEarnings:0,totalEarnings:0}),[h,v]=i.useState([]),[N,w]=i.useState(!0),[p,u]=i.useState(!1);i.useEffect(()=>{if(!r)return;(async()=>{try{const{data:t,error:o}=await g.from("referral_codes").select("*").eq("user_id",r.id).single();if(t)x(t.code);else{const d=y(r.id),{data:a,error:m}=await g.from("referral_codes").insert({user_id:r.id,code:d,commission_rate:.15}).select().single();a&&x(a.code)}await C()}catch(t){console.error("Error fetching referral code:",t),x(y(r.id))}finally{w(!1)}})()},[r]);const y=s=>{const t=s.replace(/-/g,"").substring(0,6).toUpperCase(),o=Math.random().toString(36).substring(2,5).toUpperCase();return`ALPHA${t}${o}`.substring(0,10)},C=async()=>{try{const{data:s,error:t}=await g.from("referral_conversions").select("*").eq("referrer_id",r.id).order("created_at",{ascending:!1});if(s){v(s);const o=s.filter(a=>a.status==="pending").reduce((a,m)=>a+(m.amount_earned||0),0),d=s.filter(a=>a.status==="paid").reduce((a,m)=>a+(m.amount_earned||0),0);b({clicks:0,signups:s.filter(a=>a.status==="signup").length,conversions:s.filter(a=>a.status==="pending"||a.status==="paid").length,pendingEarnings:o,paidEarnings:d,totalEarnings:o+d})}}catch(s){console.error("Error fetching stats:",s)}},k=()=>{const s=`${window.location.origin}?ref=${n}`;navigator.clipboard.writeText(s),u(!0),L.success("Lien copi√© !"),setTimeout(()=>u(!1),2e3)},z=()=>{const s=encodeURIComponent("üöÄ Rejoins Alpha Academy et deviens un expert en Business, Crypto & Trading ! Utilise mon lien pour une r√©duction exclusive :"),t=encodeURIComponent(`${window.location.origin}?ref=${n}`);window.open(`https://twitter.com/intent/tweet?text=${s}&url=${t}`,"_blank")},A=()=>{const s=encodeURIComponent(`üéì Hey ! J'apprends le business et le trading sur Alpha Academy. Utilise mon lien pour rejoindre : ${window.location.origin}?ref=${n}`);window.open(`https://wa.me/?text=${s}`,"_blank")},$=()=>{const s=encodeURIComponent("Rejoins-moi sur Alpha Academy !"),t=encodeURIComponent(`Salut !

Je me forme sur Alpha Academy et je te recommande d'y jeter un ≈ìil.

Utilise mon lien pour t'inscrire : ${window.location.origin}?ref=${n}

√Ä bient√¥t !`);window.open(`mailto:?subject=${s}&body=${t}`)},E=`${window.location.origin}?ref=${n}`;return N?e.jsx("div",{className:"pt-28 pb-20 px-4 max-w-6xl mx-auto",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-gray-800 rounded w-1/3"}),e.jsx("div",{className:"h-32 bg-gray-800 rounded"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("div",{className:"h-24 bg-gray-800 rounded"}),e.jsx("div",{className:"h-24 bg-gray-800 rounded"}),e.jsx("div",{className:"h-24 bg-gray-800 rounded"})]})]})}):e.jsxs("div",{className:"pt-28 pb-20 px-4 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-3",children:[e.jsx(_,{className:"text-accent-primary"}),"Programme d'Affiliation"]}),e.jsx("p",{className:"text-gray-400",children:"Parrainez des amis et gagnez 15% de commission sur chaque vente !"})]}),e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-premium rounded-2xl p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(O,{size:20,className:"text-accent-primary"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Votre lien de parrainage"})]}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("div",{className:"flex-1 bg-gray-900/50 rounded-lg p-3 font-mono text-sm text-gray-300 truncate border border-gray-700",children:E}),e.jsxs("button",{onClick:k,className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors ${p?"bg-green-500/20 text-green-400":"bg-accent-primary/20 text-accent-primary hover:bg-accent-primary/30"}`,children:[p?e.jsx(M,{size:18}):e.jsx(F,{size:18}),p?"Copi√© !":"Copier"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Partager sur :"}),e.jsx("button",{onClick:z,className:"p-2 bg-[#1DA1F2]/20 hover:bg-[#1DA1F2]/30 rounded-lg transition-colors",title:"Twitter",children:e.jsx(I,{size:18,className:"text-[#1DA1F2]"})}),e.jsx("button",{onClick:A,className:"p-2 bg-[#25D366]/20 hover:bg-[#25D366]/30 rounded-lg transition-colors",title:"WhatsApp",children:e.jsx(D,{size:18,className:"text-[#25D366]"})}),e.jsx("button",{onClick:$,className:"p-2 bg-gray-700/50 hover:bg-gray-700 rounded-lg transition-colors",title:"Email",children:e.jsx(S,{size:18,className:"text-gray-400"})})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[{label:"Filleuls",value:c.signups,icon:j,color:"text-blue-400"},{label:"Conversions",value:c.conversions,icon:q,color:"text-green-400"},{label:"En attente",value:`${c.pendingEarnings}‚Ç¨`,icon:T,color:"text-amber-400"},{label:"Total gagn√©",value:`${c.totalEarnings}‚Ç¨`,icon:H,color:"text-emerald-400"}].map((s,t)=>e.jsxs(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},className:"glass-card rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(s.icon,{size:20,className:s.color}),e.jsx(P,{size:14,className:"text-gray-500"})]}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.value}),e.jsx("p",{className:"text-sm text-gray-400",children:s.label})]},s.label))}),e.jsxs("div",{className:"glass-card rounded-xl p-6 mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(W,{size:20,className:"text-accent-primary"}),"Comment √ßa marche ?"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:[{step:"1",title:"Partagez",desc:"Envoyez votre lien unique √† vos amis et votre audience."},{step:"2",title:"Ils ach√®tent",desc:"Quand quelqu'un ach√®te via votre lien, vous gagnez 15%."},{step:"3",title:"Recevez",desc:"Les commissions sont pay√©es le 1er de chaque mois (min. 50‚Ç¨)."}].map(s=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-primary/20 text-accent-primary flex items-center justify-center font-bold flex-shrink-0",children:s.step}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:s.title}),e.jsx("p",{className:"text-sm text-gray-400",children:s.desc})]})]},s.step))})]}),e.jsxs("div",{className:"glass-card rounded-xl overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsx("h3",{className:"font-semibold text-white",children:"Conversions r√©centes"})}),h.length>0?e.jsx("div",{className:"divide-y divide-gray-800",children:h.slice(0,10).map((s,t)=>e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-white font-medium",children:["Filleul #",t+1]}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString("fr-FR")})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-green-400 font-medium",children:["+",s.amount_earned,"‚Ç¨"]}),e.jsx("p",{className:`text-xs ${s.status==="paid"?"text-green-500":s.status==="pending"?"text-amber-500":"text-gray-500"}`,children:s.status==="paid"?"Pay√©":s.status==="pending"?"En attente":"Inscription"})]})]},s.id||t))}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(j,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Pas encore de conversions"}),e.jsx("p",{className:"text-sm",children:"Partagez votre lien pour commencer √† gagner !"})]})]})]})};export{Q as default};

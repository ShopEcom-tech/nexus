import{c as Q,a,j as e,m as U,C as Y,X as F,s as B,H as I,k as ee,D as te,l as V,o as G,y as q,n as se,g as re,p as ae,i as oe,z as W,I as le,J as ne,b as ie}from"./index-BHyKrKGo.js";import{S as ce}from"./save-DmYh8auA.js";import{P as H}from"./plus-g_po5mX3.js";import{U as de}from"./users-CFKhssQv.js";import{C as X}from"./check-circle-CcO1vCf4.js";import{P as ue}from"./play-circle-mGKe0sfh.js";const J=Q("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),me=Q("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Z=Q("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),xe=Q("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),ge=Q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),pe=(t,g)=>{const l=`notes_${t}_${g}`,[k,f]=a.useState(()=>{const c=localStorage.getItem(l);return c?JSON.parse(c):[]});return a.useEffect(()=>{localStorage.setItem(l,JSON.stringify(k))},[k,l]),{notes:k,addNote:c=>{const u={...c,id:Date.now().toString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return f(p=>[...p,u].sort((j,w)=>j.timestamp-w.timestamp)),u},updateNote:(c,u)=>{f(p=>p.map(j=>j.id===c?{...j,...u,updatedAt:new Date().toISOString()}:j))},deleteNote:c=>{f(u=>u.filter(p=>p.id!==c))},getNotesByTimestamp:(c,u=5)=>k.filter(p=>Math.abs(p.timestamp-c)<=u)}},he=({note:t,onClick:g,onEdit:l,onDelete:k,onToggleBookmark:f})=>{const h=o=>{const b=Math.floor(o/60),c=Math.floor(o%60),u=Math.floor(b/60);return u>0?`${u}:${(b%60).toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`:`${b}:${c.toString().padStart(2,"0")}`},N=o=>new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"});return e.jsxs(U.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-20},whileHover:{x:4,scale:1.01},className:"group relative bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-xl p-4 mb-3 cursor-pointer hover:border-purple-500/50 transition-all shadow-sm hover:shadow-md",onClick:()=>g(t.timestamp),children:[t.isBookmark&&e.jsx("div",{className:"absolute -left-1 top-4 w-1 h-12 bg-gradient-to-b from-purple-600 to-pink-600 rounded-r"}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded-full text-sm font-medium cursor-pointer hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors",onClick:o=>{o.stopPropagation(),g(t.timestamp)},children:[e.jsx(Y,{size:14}),e.jsx("span",{children:h(t.timestamp)})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:o=>{o.stopPropagation(),f(t.id)},className:`p-1.5 rounded-lg transition-colors ${t.isBookmark?"text-purple-600 dark:text-purple-400 bg-purple-100 dark:bg-purple-900/30":"text-gray-400 hover:text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/20"}`,title:t.isBookmark?"Retirer favori":"Marquer comme favori",children:e.jsx(J,{size:16,fill:t.isBookmark?"currentColor":"none"})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),l(t)},className:"p-1.5 rounded-lg text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors",title:"Modifier",children:e.jsx(xe,{size:16})}),e.jsx("button",{onClick:o=>{o.stopPropagation(),window.confirm("Supprimer cette note ?")&&k(t.id)},className:"p-1.5 rounded-lg text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Supprimer",children:e.jsx(ge,{size:16})})]})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed mb-2 line-clamp-3",children:t.content}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:t.tags.map((o,b)=>e.jsxs("span",{className:"px-2 py-0.5 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 text-xs rounded-full",children:["#",o]},b))}),e.jsx("div",{className:"text-xs text-gray-400 dark:text-gray-600",children:N(t.updatedAt)})]})},ye=({note:t,onSave:g,onCancel:l,currentTimestamp:k})=>{const[f,h]=a.useState((t==null?void 0:t.content)||""),[N,o]=a.useState((t==null?void 0:t.tags)||[]),[b,c]=a.useState(""),[u,p]=a.useState((t==null?void 0:t.isBookmark)||!1),j=a.useRef(null);a.useEffect(()=>{j.current&&j.current.focus()},[]);const w=m=>{m.preventDefault();const r=b.trim().toLowerCase();r&&!N.includes(r)&&(o([...N,r]),c(""))},L=m=>{o(N.filter(r=>r!==m))},A=()=>{if(!f.trim())return;const m=(t==null?void 0:t.timestamp)??k;g({...t||{},content:f.trim(),tags:N,isBookmark:u,timestamp:m})},M=m=>{m.ctrlKey&&m.key==="Enter"&&A(),m.key==="Escape"&&l()};return e.jsx(U.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:l,children:e.jsxs(U.div,{initial:{y:20},animate:{y:0},className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 max-w-2xl w-full max-h-[90vh] overflow-hidden",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t?"Modifier la note":"Nouvelle note"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Timestamp: ",Math.floor(((t==null?void 0:t.timestamp)??k)/60),":",String(Math.floor(((t==null?void 0:t.timestamp)??k)%60)).padStart(2,"0")]})]}),e.jsx("button",{onClick:l,className:"p-2 rounded-lg text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:e.jsx(F,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto max-h-[calc(90vh-200px)]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Contenu de la note"}),e.jsx("textarea",{ref:j,value:f,onChange:m=>h(m.target.value),onKeyDown:M,placeholder:"Ã‰crivez votre note ici... (Ctrl+Enter pour sauvegarder)",className:"w-full h-40 px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 transition-shadow"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:()=>p(!u),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${u?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 border-2 border-purple-500":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-2 border-transparent hover:border-purple-300"}`,children:[e.jsx(J,{size:16,fill:u?"currentColor":"none"}),e.jsx("span",{className:"text-sm font-medium",children:"Marquer comme favori"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Tags (optionnel)"}),e.jsxs("form",{onSubmit:w,className:"flex gap-2 mb-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",value:b,onChange:m=>c(m.target.value),placeholder:"Ajouter un tag (ex: important, revision)",className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsx(B,{type:"submit",variant:"outline",size:"sm",children:"Ajouter"})]}),N.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:N.map((m,r)=>e.jsxs(U.span,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 rounded-full text-sm",children:[e.jsx(Z,{size:12}),m,e.jsx("button",{onClick:()=>L(m),className:"ml-1 hover:bg-purple-200 dark:hover:bg-purple-800 rounded-full p-0.5 transition-colors",children:e.jsx(F,{size:12})})]},r))})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ðŸ’¡ Astuce: Utilisez Ctrl+Enter pour sauvegarder rapidement"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(B,{onClick:l,variant:"outline",children:"Annuler"}),e.jsxs(B,{onClick:A,disabled:!f.trim(),className:"flex items-center gap-2",children:[e.jsx(ce,{size:16}),"Sauvegarder"]})]})]})]})})},fe=({courseId:t,lessonId:g,videoRef:l,isVisible:k})=>{var T;const{notes:f,addNote:h,updateNote:N,deleteNote:o}=pe(t,g),[b,c]=a.useState(null),[u,p]=a.useState(!1),[j,w]=a.useState(""),[L,A]=a.useState(!1),M=()=>{var i;const s=((i=l==null?void 0:l.current)==null?void 0:i.currentTime)||0;p(!0),c({timestamp:s})},m=s=>{s.id?N(s.id,s):h(s),c(null),p(!1)},r=s=>{c(s),p(!1)},n=s=>{l!=null&&l.current&&(l.current.currentTime=s,l.current.play())},y=s=>{const i=f.find(S=>S.id===s);i&&N(s,{isBookmark:!i.isBookmark})},v=()=>{const s=x(f),i=new Blob([s],{type:"text/markdown"}),S=URL.createObjectURL(i),E=document.createElement("a");E.href=S,E.download=`notes_${t}_${g}_${Date.now()}.md`,E.click(),URL.revokeObjectURL(S)},x=s=>{let i=`# Notes - Cours ${t} - LeÃ§on ${g}

`;return i+=`ðŸ“… ExportÃ© le ${new Date().toLocaleDateString("fr-FR")}

`,i+=`---

`,s.forEach((S,E)=>{const O=C(S.timestamp);i+=`## Note ${E+1} ${S.isBookmark?"â­":""}
`,i+=`**â±ï¸ Timestamp:** ${O}

`,i+=`${S.content}

`,S.tags&&S.tags.length>0&&(i+=`**ðŸ·ï¸ Tags:** ${S.tags.map(d=>`#${d}`).join(", ")}

`),i+=`---

`}),i},C=s=>{const i=Math.floor(s/60),S=Math.floor(s%60);return`${i}:${S.toString().padStart(2,"0")}`},z=f.filter(s=>{const i=s.content.toLowerCase().includes(j.toLowerCase())||s.tags&&s.tags.some(E=>E.includes(j.toLowerCase())),S=!L||s.isBookmark;return i&&S});return k?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"h-full flex flex-col bg-gray-50 dark:bg-black border-l border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(I,{className:"text-purple-600 dark:text-purple-400",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white",children:"Mes Notes"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[z.length," note",z.length!==1?"s":""]})]})]}),e.jsxs(B,{onClick:M,size:"sm",className:"flex items-center gap-2",children:[e.jsx(H,{size:16}),"Ajouter"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",value:j,onChange:s=>w(s.target.value),placeholder:"Rechercher dans les notes...",className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500"}),j&&e.jsx("button",{onClick:()=>w(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(F,{size:16})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>A(!L),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm transition-all ${L?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 border border-purple-500":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 border border-transparent"}`,children:[e.jsx(J,{size:14,fill:L?"currentColor":"none"}),"Favoris"]}),f.length>0&&e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:[e.jsx(te,{size:14}),"Exporter"]})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx(V,{mode:"popLayout",children:z.length===0?e.jsxs(U.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center h-full text-center p-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx(I,{className:"text-gray-400",size:32})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:j?"Aucune note trouvÃ©e":"Aucune note"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:j?"Essayez avec d'autres mots-clÃ©s":'CrÃ©ez votre premiÃ¨re note en cliquant sur "Ajouter"'}),!j&&e.jsxs(B,{onClick:M,size:"sm",children:[e.jsx(H,{size:16,className:"mr-2"}),"CrÃ©er une note"]})]}):z.map(s=>e.jsx(he,{note:s,onClick:n,onEdit:r,onDelete:o,onToggleBookmark:y},s.id))})}),e.jsx("div",{className:"p-3 border-t border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900",children:e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"ðŸ’¡ Cliquez sur une note pour revenir au moment exact de la vidÃ©o"})})]}),e.jsx(V,{children:(b||u)&&e.jsx(ye,{note:b,currentTimestamp:((T=l==null?void 0:l.current)==null?void 0:T.currentTime)||0,onSave:m,onCancel:()=>{c(null),p(!1)}})})]}):null},be=t=>{const{user:g}=G(),[l,k]=a.useState({}),[f,h]=a.useState(!0),[N,o]=a.useState(null),b=a.useRef(null),c=a.useRef({}),u=(r,n)=>`${r}_${n}`,p=a.useCallback(async()=>{if(!g||!t){h(!1);return}try{const{data:r,error:n}=await q.from("lesson_progress").select("*").eq("user_id",g.id).eq("course_slug",t);if(n)throw n;const y={};let v=null;r==null||r.forEach(x=>{const C=u(x.module_index,x.lesson_index);y[C]={progressSeconds:x.progress_seconds,durationSeconds:x.duration_seconds,completed:x.completed,lastWatchedAt:x.last_watched_at},(!v||new Date(x.last_watched_at)>new Date(v.lastWatchedAt))&&(v={moduleIndex:x.module_index,lessonIndex:x.lesson_index,lastWatchedAt:x.last_watched_at})}),k(y),o(v)}catch(r){console.error("Error loading progress:",r);const n=localStorage.getItem(`progress-${t}`);n&&k(JSON.parse(n))}finally{h(!1)}},[g,t]),j=a.useCallback(async(r,n,y,v)=>{if(!g||!t)return;const x=u(r,n),C=v>0&&y/v>=.9;k(z=>({...z,[x]:{progressSeconds:y,durationSeconds:v,completed:C,lastWatchedAt:new Date().toISOString()}})),o({moduleIndex:r,lessonIndex:n,lastWatchedAt:new Date().toISOString()}),c.current[x]={moduleIndex:r,lessonIndex:n,progressSeconds:y,durationSeconds:v,completed:C},b.current&&clearTimeout(b.current),b.current=setTimeout(async()=>{const z={...c.current};c.current={};for(const T of Object.keys(z)){const s=z[T];try{const{error:i}=await q.from("lesson_progress").upsert({user_id:g.id,course_slug:t,module_index:s.moduleIndex,lesson_index:s.lessonIndex,progress_seconds:s.progressSeconds,duration_seconds:s.durationSeconds,completed:s.completed,last_watched_at:new Date().toISOString()},{onConflict:"user_id,course_slug,module_index,lesson_index"});if(i)throw i}catch(i){console.error("Error saving progress:",i),localStorage.setItem(`progress-${t}`,JSON.stringify(l))}}},5e3),localStorage.setItem(`progress-${t}`,JSON.stringify({...l,[x]:{progressSeconds:y,durationSeconds:v,completed:C}}))},[g,t,l]),w=a.useCallback(async(r,n,y=0)=>{if(!g||!t)return;const v=u(r,n);try{const{error:x}=await q.from("lesson_progress").upsert({user_id:g.id,course_slug:t,module_index:r,lesson_index:n,progress_seconds:y,duration_seconds:y,completed:!0,last_watched_at:new Date().toISOString()},{onConflict:"user_id,course_slug,module_index,lesson_index"});if(x)throw x;k(C=>({...C,[v]:{progressSeconds:y,durationSeconds:y,completed:!0,lastWatchedAt:new Date().toISOString()}}))}catch(x){console.error("Error marking as completed:",x)}},[g,t]),L=a.useCallback((r,n)=>{const y=u(r,n);return l[y]||{progressSeconds:0,durationSeconds:0,completed:!1}},[l]),A=a.useCallback((r,n)=>{const{progressSeconds:y,durationSeconds:v}=L(r,n);return v===0?0:Math.min(100,Math.round(y/v*100))},[L]),M=a.useCallback((r,n)=>L(r,n).completed,[L]),m=a.useCallback(r=>{if(!r||r.length===0)return 0;let n=0,y=0;return r.forEach((v,x)=>{var C;(C=v.lessons)==null||C.forEach((z,T)=>{n++,M(x,T)&&y++})}),n>0?Math.round(y/n*100):0},[M]);return a.useEffect(()=>{p()},[p]),a.useEffect(()=>()=>{b.current&&clearTimeout(b.current)},[]),{progress:l,loading:f,lastWatched:N,saveProgress:j,markAsCompleted:w,getLessonProgress:L,getLessonProgressPercent:A,isLessonCompleted:M,getCourseProgress:m,loadProgress:p}},Se=()=>{const{slug:t}=se(),g=re(),{enrollments:l}=G(),{setCourseContext:k}=ae(),f=a.useRef(null),[h,N]=a.useState(0),[o,b]=a.useState(0),[c,u]=a.useState(!0),[p,j]=a.useState(!0),[w,L]=a.useState(null),[A,M]=a.useState(!0),{saveProgress:m,markAsCompleted:r,getLessonProgress:n,getLessonProgressPercent:y,isLessonCompleted:v,getCourseProgress:x,lastWatched:C,loading:z}=be(t);a.useEffect(()=>{const d=oe.find($=>$.slug===t),_=l.some($=>$.course.slug===t);d&&_?L(d):(W.error("AccÃ¨s non autorisÃ©"),g("/dashboard")),M(!1)},[t,l,g]),a.useEffect(()=>{var d;if(w){const _=(d=w.modules)==null?void 0:d[h],$=_?`Module: ${_.title}. LeÃ§ons: ${_.lessons.map(P=>P.title).join(", ")}.`:"";k({courseName:w.title,courseId:w.id,courseSlug:w.slug,currentModule:$,activeModuleIndex:h,activeLessonIndex:o})}return()=>k({})},[w,h,o,k]),a.useEffect(()=>{C&&!z&&(N(C.moduleIndex),b(C.lessonIndex))},[C,z]),a.useEffect(()=>{const d=f.current;if(!d)return;const _=()=>{m(h,o,d.currentTime,d.duration)},$=()=>{r(h,o,d.duration),W.success("LeÃ§on terminÃ©e ! ðŸŽ‰")},P=()=>{const{progressSeconds:D}=n(h,o);D>0&&D<d.duration-5&&(d.currentTime=D,W("Reprise de la lecture...",{icon:"â–¶ï¸",duration:2e3}))};return d.addEventListener("timeupdate",_),d.addEventListener("ended",$),d.addEventListener("loadedmetadata",P),()=>{d.removeEventListener("timeupdate",_),d.removeEventListener("ended",$),d.removeEventListener("loadedmetadata",P)}},[h,o,m,r,n]);const T=()=>{const d=f.current;r(h,o,(d==null?void 0:d.duration)||0),W.success("LeÃ§on marquÃ©e comme vue ! âœ“")};if(A||!w)return e.jsx(le,{isLoading:!0,message:"Chargement de votre cours..."});const s=[{title:"Module 1: Introduction & Mindset",lessons:[{title:"Bienvenue dans la formation",duration:"05:20",type:"video",videoUrl:"https://www.youtube.com/watch?v=dQw4w9WgXcQ"},{title:"Le Mindset du gagnant",duration:"12:45",type:"video",videoUrl:"https://www.youtube.com/watch?v=dQw4w9WgXcQ"},{title:"Rejoindre la communautÃ© privÃ©e",duration:"02:00",type:"text"}]},{title:"Module 2: Les Fondamentaux",lessons:[{title:"Comprendre l'Ã©cosystÃ¨me",duration:"15:30",type:"video",videoUrl:"https://www.youtube.com/watch?v=dQw4w9WgXcQ"},{title:"Configuration des outils",duration:"20:10",type:"video",videoUrl:"https://www.youtube.com/watch?v=dQw4w9WgXcQ"},{title:"Ressources Ã  tÃ©lÃ©charger",duration:"00:00",type:"resource"}]}],i=s[h].lessons[o],S=`${h}_${o}`,E=x(s),O=v(h,o);return e.jsxs("div",{className:"min-h-screen bg-black text-white flex flex-col",children:[e.jsxs("header",{className:"h-16 border-b border-gray-800 flex items-center justify-between px-4 bg-gray-900/50 backdrop-blur-sm fixed w-full z-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>g("/dashboard"),className:"p-2 hover:bg-gray-800 rounded-full transition-colors",children:e.jsx(me,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg hidden md:block",children:w.title}),e.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-gray-400",children:[e.jsx("div",{className:"w-32 h-1.5 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-400 transition-all duration-500",style:{width:`${E}%`}})}),e.jsxs("span",{children:[E,"% complÃ©tÃ©"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>j(!p),className:`hidden md:flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm transition-all ${p?"bg-purple-600 text-white":"bg-gray-800 text-gray-400 hover:bg-gray-700"}`,children:[e.jsx(I,{size:16}),"Notes"]}),e.jsxs("button",{onClick:()=>W("Watch Party - Prochainement !",{icon:"ðŸŽ‰"}),className:"hidden md:flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm bg-gray-800 text-gray-400 hover:bg-gray-700 transition-colors",children:[e.jsx(de,{size:16}),"Watch Party"]}),e.jsx("button",{onClick:()=>u(!c),className:"p-2 hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(ne,{size:20})})]})]}),e.jsxs("div",{className:"flex flex-1 pt-16 h-screen overflow-hidden",children:[e.jsx("main",{className:`flex-1 overflow-y-auto p-4 md:p-8 transition-all ${p?"mr-0 md:mr-96":""}`,children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"aspect-video bg-gray-900 rounded-xl border border-gray-800 mb-6 overflow-hidden",children:i.type==="video"?e.jsx("video",{ref:f,className:"w-full h-full",controls:!0,src:i.videoUrl,children:"Votre navigateur ne supporte pas la lecture vidÃ©o."}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-center p-8",children:e.jsxs("div",{children:[e.jsx(I,{size:48,className:"mx-auto mb-4 text-gray-600"}),e.jsx("h3",{className:"text-xl font-bold text-gray-300 mb-4",children:"Contenu Textuel"}),e.jsx(B,{variant:"primary",children:"AccÃ©der au contenu"})]})})}),e.jsxs("div",{className:"flex justify-between items-start mb-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold",children:i.title}),O&&e.jsxs("span",{className:"flex items-center gap-1 text-xs bg-green-500/20 text-green-400 px-2 py-1 rounded-full",children:[e.jsx(ie,{size:12})," Vu"]})]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Module ",h+1," â€¢ LeÃ§on ",o+1]})]}),e.jsxs(B,{variant:O?"outline":"primary",className:"gap-2",onClick:T,disabled:O,children:[e.jsx(X,{size:16}),O?"DÃ©jÃ  vu":"Marquer comme vu"]})]}),e.jsxs("div",{className:"prose prose-invert max-w-none",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Ã€ propos de cette leÃ§on"}),e.jsx("p",{className:"text-gray-400 leading-relaxed",children:"Dans cette leÃ§on, nous allons explorer les concepts fondamentaux. Prenez des notes et n'hÃ©sitez pas Ã  revenir sur les points clÃ©s."})]})]})}),p&&e.jsx("div",{className:"hidden md:block fixed right-0 top-16 h-[calc(100vh-4rem)] w-96 z-40",children:e.jsx(fe,{courseId:t,lessonId:S,videoRef:f,isVisible:p})}),e.jsxs("aside",{className:`${c?"translate-x-0":"translate-x-full"} md:translate-x-0 w-80 transition-all duration-300 bg-gray-900 border-l border-gray-800 fixed md:relative right-0 h-[calc(100vh-64px)] overflow-y-auto z-30`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-800",children:[e.jsx("h3",{className:"font-bold text-gray-300",children:"Contenu du cours"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[E,"% complÃ©tÃ©"]})]}),e.jsx("div",{className:"p-2",children:s.map((d,_)=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 px-2",children:d.title}),e.jsx("div",{className:"space-y-1",children:d.lessons.map(($,P)=>{const D=h===_&&o===P,R=v(_,P),K=y(_,P);return e.jsxs("button",{onClick:()=>{N(_),b(P),window.innerWidth<768&&u(!1)},className:`w-full flex flex-col gap-1 p-3 rounded-lg text-left transition-colors ${D?"bg-indigo-600 text-white":"hover:bg-gray-800 text-gray-400"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[R?e.jsx(X,{size:16,className:"text-green-400 flex-shrink-0"}):$.type==="video"?e.jsx(ue,{size:16,className:"flex-shrink-0"}):e.jsx(I,{size:16,className:"flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium truncate ${D?"text-white":"text-gray-300"}`,children:$.title}),e.jsx("p",{className:"text-xs opacity-70",children:$.duration})]}),D&&e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full flex-shrink-0"})]}),!R&&K>0&&e.jsx("div",{className:"w-full h-1 bg-gray-700 rounded-full overflow-hidden ml-7",children:e.jsx("div",{className:"h-full bg-indigo-400 transition-all",style:{width:`${K}%`}})})]},P)})})]},_))})]})]})]})};export{Se as default};
